FormInfo ^{
    br=<br>
}
Script ^{
    Mod_ExpProgramsNPC ^{
        ProgramsDistributionChances ^{
            Diplomat=8:4, DistressSignal:0, Shocker5300:50, GatrixMatrix:23, WCoder:18, SystemShutdown:6, AbsoluteWeapon:3
            EliteWarrior=15:4, DistressSignal:0, Shocker5300:40, GatrixMatrix:25, WCoder:25, SystemShutdown:8, AbsoluteWeapon:2
            FemRanger=40:7, DistressSignal:15, Shocker5300:15, GatrixMatrix:25, WCoder:25, SystemShutdown:12, AbsoluteWeapon:8
            Pirate=5:3, DistressSignal:55, Shocker5300:20, GatrixMatrix:10, WCoder:10, SystemShutdown:4, AbsoluteWeapon:1
            PirateCorvette=10:5, DistressSignal:35, Shocker5300:26, GatrixMatrix:15, WCoder:15, SystemShutdown:6, AbsoluteWeapon:3
            Ranger=30:5, DistressSignal:40, Shocker5300:20, GatrixMatrix:15, WCoder:15, SystemShutdown:7, AbsoluteWeapon:3
            RangerExplorer=30:5, DistressSignal:40, Shocker5300:20, GatrixMatrix:15, WCoder:15, SystemShutdown:7, AbsoluteWeapon:3
            RangerPirate=30:5, DistressSignal:40, Shocker5300:20, GatrixMatrix:15, WCoder:15, SystemShutdown:7, AbsoluteWeapon:3
            RangerPirateExplorer=30:5, DistressSignal:40, Shocker5300:20, GatrixMatrix:15, WCoder:15, SystemShutdown:7, AbsoluteWeapon:3
            ReadMe=Параметр ShipTypes отвечает за то, какие типы кораблей в принципе будут получать программы. Параметры с именами типов отвечают за перечень получаемых данным типом корабля программ. Первая цифра в параметре - это общий шанс получения данным кораблём инфошки применения программ, а также шанс пополнения запаса программ конкретного корабля, если число программ у него ещё не максимально. Цифра через двоеточие после первой - это максимальное число программ, которые могут единовременно находиться в наличии у корабля данного типа (плюс такое же число "Интеркомов"). Имя программы и число через двоеточие - это шанс получения кораблём конкретной программы в случае пополнения. При этом общая сумма шансов получения различных программ должна составлять 100%. Не забывайте также обновлять параметр Version в случае внесения любых изменений, иначе изменения не применятся на игровых сейвах.
            ShipTypes=Ranger,RangerExplorer,RangerPirate,RangerPirateExplorer,FemRanger,Warrior,EliteWarrior,Pirate,PirateCorvette,Diplomat,Smuggler
            Smuggler=7:3, DistressSignal:0, Shocker5300:60, GatrixMatrix:20, WCoder:17, SystemShutdown:3, AbsoluteWeapon:0
            Version=29.07.2021
            Warrior=8:3, DistressSignal:0, Shocker5300:40, GatrixMatrix:25, WCoder:25, SystemShutdown:8, AbsoluteWeapon:2
        }
    }
}
ShipInfo ^{
    AddInfo ^{
        CustomInfos ^{
            ProgramAbsoluteWeaponNPC ^{
                Description=Приказ нулевого уровня на самоуничтожение. Доминаторы подчиняются беспрекословно.
                Description=<clr><clrEnd>
                Description=Количество запусков: <Data1> шт.
                DescriptionEng=Level zero command self-destruct. Cannot be resisted by dominators.
                DescriptionEng=<clr><clrEnd>
                DescriptionEng=Number of runs: <Data1>
                Icon=3
                Name=Абсолютное оружие
                NameEng=Absolute weapon
                OnActCode ^{
                    01=dword cur_info = CurInfo();
                    02=dword cur_ship = ScriptItemActShip();
                    03=if(!ShipInNormalSpace(cur_ship)) exit;
                    04=if(!StarBattle(ShipStar(cur_ship))) exit;
                    05=int in_fear = ShipInFear(cur_ship);
                    06=if(ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 3) > CurTurn()) exit;
                    07=if(!fun_init)
                    08 ^{
                        01=unknown ShipNearbyShips = ImportedFunction('UtilityFunctions', 'ShipNearbyShips');
                        02=unknown RndObject = ImportedFunction('UtilityFunctions', 'RndObject');
                        03=int fun_init = 1;
                    }
                    09=dword target;
                    10=if(!in_fear) target = ShipGetBad(cur_ship);
                    11=else
                    12 ^{
                        01=target = ShipNearbyShips(cur_ship, 1, 0, 1, '', '');
                    }
                    13=if(!target) exit;
                    14=if(ShipTypeN(target)) exit;
                    15=if(ShipCustomFaction(target) != '') exit;
                    16=if(DomikProgrammDate(target)) exit;
                    17=if(!in_fear)
                    18 ^{
                        01=if(RndObject(1, 100, cur_ship) <= abs(HullDamage(target) - 100) - 65) exit;
                    }
                    19=else
                    20 ^{
                        01=if(RndObject(1, 100, cur_ship) <= HullDamage(cur_ship) + 10) exit;
                    }
                    21=int sub_type = ShipSubType(target);
                    22=if(!sub_type || sub_type > 3) exit;
                    23=if(ShipScanerPower(cur_ship) <= ShipProtectability(target)) exit;
                    24=if(!in_fear)
                    25 ^{
                        01=if(Dist(cur_ship, target) > 350) exit;
                    }
                    26=else
                    27 ^{
                        01=if(Dist(cur_ship, target) > 350) exit;
                    }
                    28=DomikProgramm(target, 10);
                    29=if(ShipCustomShipInfoData(0, CurInfo(), 1) > 1)
                    30 ^{
                        01=ShipCustomShipInfoData(0, CurInfo(), 1, ShipCustomShipInfoData(0, CurInfo(), 1) - 1);
                    }
                    31=else
                    32 ^{
                        01=ShipDeleteCustomShipInfo(cur_ship, 'ProgramAbsoluteWeaponNPC');
                    }
                    33=if(ShipCustomShipInfoData(cur_ship, 'ProgramIntercomNPC', 1) > 1)
                    34 ^{
                        01=ShipCustomShipInfoData(cur_ship, 'ProgramIntercomNPC', 1, ShipCustomShipInfoData(cur_ship, 'ProgramIntercomNPC', 1) - 1);
                    }
                    35=else
                    36 ^{
                        01=ShipDeleteCustomShipInfo(cur_ship, 'ProgramIntercomNPC');
                    }
                    37=ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 1, ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 1) - 1);
                    38=if(!in_fear) ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 3, CurTurn() + 18);
                    39=else ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 3, CurTurn() + 6);
                    40=if(ShipInNormalSpace(Player()))
                    41 ^{
                        01=if(ShipStar(cur_ship) == ShipStar(Player()))
                        02 ^{
                            01=if(Dist(cur_ship, Player()) <= ShipRadarRange(Player()))
                            02 ^{
                                01=str text = ItemSubrace(ShipItems(target, 0));
                                02=if(!text) text = 'Blazer';
                                03=else if(1 == text) text = 'Keller';
                                04=else text = 'Terron';
                                05=if(RndObject(0, 1, cur_ship)) text = text + '1';
                                06=str player_name = ShipName(Player());
                                07=SetName(Player(), '*#*NameReplace*#*');
                                08=text = Format(CT('ShipGreetings.Dominator.' + text), CT('ShipType.TypeName.Ranger') + ' *#*NameReplace*#*', Format(Name(cur_ship), ShipName(cur_ship), '*#*NameReplace*#*', ''), '');
                                09=text = Format(text, '*#*NameReplace*#*', ShipName(cur_ship), '255,240,100');
                                10=SetName(Player(), player_name);
                                11=str prog_name = CT('Programms.SelfDestruction.Name');
                                12=text = '<color=255,240,100>' + Name(cur_ship) + '</color>' + '-->' + '<color=255,240,100>' + Name(target) + '</color>' + CT('FormInfo.br') + '- ' + text + CT('FormInfo.br') + '- ' + Format(CT('Talk.Dominator.ProgrammPlayer'), '<Name' + '>', prog_name, '255,240,100') + CT('FormInfo.br') + '- ' + Format(CT('Talk.Dominator.ProgrammOk'), '<Name' + '>', prog_name, '255,240,100');
                                13=Ether(1, '', text, cur_ship, target);
                            }
                        }
                    }
                }
                OnActCodeTypes=t_OnStep
                OnActStepTypes=5
            }
            ProgramDistressSignalNPC ^{
                Description=Получив аварийный сигнал, доминатор выбросит часть оборудования и оружия.
                Description=<clr><clrEnd>
                Description=Количество запусков: <Data1> шт.
                DescriptionEng=Upon receiving a distress signal, the dominator will dump some of its equipment and weapons.
                DescriptionEng=<clr><clrEnd>
                DescriptionEng=Number of runs: <Data1>
                Icon=3
                Name=Аварийный сигнал
                NameEng=Distress signal
                OnActCode ^{
                    01=dword cur_info = CurInfo();
                    02=dword cur_ship = ScriptItemActShip();
                    03=if(!ShipInNormalSpace(cur_ship)) exit;
                    04=if(!StarBattle(ShipStar(cur_ship))) exit;
                    05=if(!fun_init)
                    06 ^{
                        01=unknown RndObject = ImportedFunction('UtilityFunctions', 'RndObject');
                        02=int fun_init = 1;
                    }
                    07=if(RndObject(1, 100, cur_ship) <= 60) exit;
                    08=if(ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 3) > CurTurn()) exit;
                    09=if(ShipInFear(cur_ship)) exit;
                    10=dword target = ShipGetBad(cur_ship);
                    11=if(!target) exit;
                    12=if(ShipTypeN(target)) exit;
                    13=if(ShipCustomFaction(target) != '') exit;
                    14=if(DomikProgrammDate(target)) exit;
                    15=int sub_type = ShipSubType(target);
                    16=if(!sub_type || sub_type > 5) exit;
                    17=if(ShipScanerPower(cur_ship) <= ShipProtectability(target)) exit;
                    18=if(Dist(cur_ship, target) > 350) exit;
                    19=DomikProgramm(target, 6);
                    20=if(ShipCustomShipInfoData(0, CurInfo(), 1) > 1)
                    21 ^{
                        01=ShipCustomShipInfoData(0, CurInfo(), 1, ShipCustomShipInfoData(0, CurInfo(), 1) - 1);
                    }
                    22=else
                    23 ^{
                        01=ShipDeleteCustomShipInfo(cur_ship, 'ProgramDistressSignalNPC');
                    }
                    24=if(ShipCustomShipInfoData(cur_ship, 'ProgramIntercomNPC', 1) > 1)
                    25 ^{
                        01=ShipCustomShipInfoData(cur_ship, 'ProgramIntercomNPC', 1, ShipCustomShipInfoData(cur_ship, 'ProgramIntercomNPC', 1) - 1);
                    }
                    26=else
                    27 ^{
                        01=ShipDeleteCustomShipInfo(cur_ship, 'ProgramIntercomNPC');
                    }
                    28=ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 1, ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 1) - 1);
                    29=ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 3, CurTurn() + 10);
                    30=if(ShipInNormalSpace(Player()))
                    31 ^{
                        01=if(ShipStar(cur_ship) == ShipStar(Player()))
                        02 ^{
                            01=if(Dist(cur_ship, Player()) <= ShipRadarRange(Player()))
                            02 ^{
                                01=str text = ItemSubrace(ShipItems(target, 0));
                                02=if(!text) text = 'Blazer';
                                03=else if(1 == text) text = 'Keller';
                                04=else text = 'Terron';
                                05=if(RndObject(0, 1, cur_ship)) text = text + '1';
                                06=str player_name = ShipName(Player());
                                07=SetName(Player(), '*#*NameReplace*#*');
                                08=text = Format(CT('ShipGreetings.Dominator.' + text), CT('ShipType.TypeName.Ranger') + ' *#*NameReplace*#*', Format(Name(cur_ship), ShipName(cur_ship), '*#*NameReplace*#*', ''), '');
                                09=text = Format(text, '*#*NameReplace*#*', ShipName(cur_ship), '255,240,100');
                                10=SetName(Player(), player_name);
                                11=str prog_name = CT('Programms.Shipwreck.Name');
                                12=text = '<color=255,240,100>' + Name(cur_ship) + '</color>' + '-->' + '<color=255,240,100>' + Name(target) + '</color>' + CT('FormInfo.br') + '- ' + text + CT('FormInfo.br') + '- ' + Format(CT('Talk.Dominator.ProgrammPlayer'), '<Name' + '>', prog_name, '255,240,100') + CT('FormInfo.br') + '- ' + Format(CT('Talk.Dominator.ProgrammOk'), '<Name' + '>', prog_name, '255,240,100');
                                13=Ether(1, '', text, cur_ship, target);
                            }
                        }
                    }
                }
                OnActCodeTypes=t_OnStep
                OnActStepTypes=5
            }
            ProgramGatrixMatrixNPC ^{
                Description=Огромная матрица беспорядочных данных перегружает электронные схемы робота потоком информации. Робот бессмысленно летает и стреляет наугад.
                Description=<clr><clrEnd>
                Description=Количество запусков: <Data1> шт.
                DescriptionEng=A giant matrix of chaotic data overloads the robot's electronic circuits with a torrent of information, forcing the target to fly and shoot aimlessly.
                DescriptionEng=<clr><clrEnd>
                DescriptionEng=Number of runs: <Data1>
                Icon=3
                Name=Гатрикс матрица
                NameEng=Gatrix matrix
                OnActCode ^{
                    01=dword cur_info = CurInfo();
                    02=dword cur_ship = ScriptItemActShip();
                    03=if(!ShipInNormalSpace(cur_ship)) exit;
                    04=if(!StarBattle(ShipStar(cur_ship))) exit;
                    05=int in_fear = ShipInFear(cur_ship);
                    06=if(ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 3) > CurTurn()) exit;
                    07=if(!fun_init)
                    08 ^{
                        01=unknown ShipNearbyShips = ImportedFunction('UtilityFunctions', 'ShipNearbyShips');
                        02=unknown RndObject = ImportedFunction('UtilityFunctions', 'RndObject');
                        03=int fun_init = 1;
                    }
                    09=dword target;
                    10=if(!in_fear) target = ShipGetBad(cur_ship);
                    11=else
                    12 ^{
                        01=target = ShipNearbyShips(cur_ship, 1, 0, 1, '', '');
                    }
                    13=if(!target) exit;
                    14=if(ShipTypeN(target)) exit;
                    15=if(ShipCustomFaction(target) != '') exit;
                    16=if(DomikProgrammDate(target)) exit;
                    17=if(!in_fear)
                    18 ^{
                        01=if(RndObject(1, 100, cur_ship) <= abs(HullDamage(target) - 100) - 33) exit;
                    }
                    19=else
                    20 ^{
                        01=if(RndObject(1, 100, cur_ship) <= HullDamage(cur_ship) + 25) exit;
                    }
                    21=int sub_type = ShipSubType(target);
                    22=if(!sub_type || sub_type > 5) exit;
                    23=if(ShipScanerPower(cur_ship) <= ShipProtectability(target)) exit;
                    24=if(!in_fear)
                    25 ^{
                        01=if(Dist(cur_ship, target) > 350) exit;
                    }
                    26=else
                    27 ^{
                        01=if(Dist(cur_ship, target) > 400) exit;
                    }
                    28=DomikProgramm(target, 8);
                    29=if(ShipCustomShipInfoData(0, CurInfo(), 1) > 1)
                    30 ^{
                        01=ShipCustomShipInfoData(0, CurInfo(), 1, ShipCustomShipInfoData(0, CurInfo(), 1) - 1);
                    }
                    31=else
                    32 ^{
                        01=ShipDeleteCustomShipInfo(cur_ship, 'ProgramGatrixMatrixNPC');
                    }
                    33=if(ShipCustomShipInfoData(cur_ship, 'ProgramIntercomNPC', 1) > 1)
                    34 ^{
                        01=ShipCustomShipInfoData(cur_ship, 'ProgramIntercomNPC', 1, ShipCustomShipInfoData(cur_ship, 'ProgramIntercomNPC', 1) - 1);
                    }
                    35=else
                    36 ^{
                        01=ShipDeleteCustomShipInfo(cur_ship, 'ProgramIntercomNPC');
                    }
                    37=ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 1, ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 1) - 1);
                    38=if(!in_fear) ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 3, CurTurn() + 10);
                    39=else ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 3, CurTurn() + 2);
                    40=if(ShipInNormalSpace(Player()))
                    41 ^{
                        01=if(ShipStar(cur_ship) == ShipStar(Player()))
                        02 ^{
                            01=if(Dist(cur_ship, Player()) <= ShipRadarRange(Player()))
                            02 ^{
                                01=str text = ItemSubrace(ShipItems(target, 0));
                                02=if(!text) text = 'Blazer';
                                03=else if(1 == text) text = 'Keller';
                                04=else text = 'Terron';
                                05=if(RndObject(0, 1, cur_ship)) text = text + '1';
                                06=str player_name = ShipName(Player());
                                07=SetName(Player(), '*#*NameReplace*#*');
                                08=text = Format(CT('ShipGreetings.Dominator.' + text), CT('ShipType.TypeName.Ranger') + ' *#*NameReplace*#*', Format(Name(cur_ship), ShipName(cur_ship), '*#*NameReplace*#*', ''), '');
                                09=text = Format(text, '*#*NameReplace*#*', ShipName(cur_ship), '255,240,100');
                                10=SetName(Player(), player_name);
                                11=str prog_name = CT('Programms.Insanity.Name');
                                12=text = '<color=255,240,100>' + Name(cur_ship) + '</color>' + '-->' + '<color=255,240,100>' + Name(target) + '</color>' + CT('FormInfo.br') + '- ' + text + CT('FormInfo.br') + '- ' + Format(CT('Talk.Dominator.ProgrammPlayer'), '<Name' + '>', prog_name, '255,240,100') + CT('FormInfo.br') + '- ' + Format(CT('Talk.Dominator.ProgrammOk'), '<Name' + '>', prog_name, '255,240,100');
                                13=Ether(1, '', text, cur_ship, target);
                            }
                        }
                    }
                }
                OnActCodeTypes=t_OnStep
                OnActStepTypes=5
            }
            ProgramIntercomNPC ^{
                Description=Программа загружается в бортовой компьютер, она позволяет декодировать речь доминаторов. Для большинства доминаторов необходимо преодолеть защитное поле с помощью сканера.
                Description=<clr><clrEnd>
                Description=Количество запусков: <Data1> шт.
                DescriptionEng=Once uploaded to the onboard computer, the program is able to decode dominator speech. With most dominators, you must first break through the defensive field with a scanner.
                DescriptionEng=<clr><clrEnd>
                DescriptionEng=Number of runs: <Data1>
                Icon=3
                Name=Интерком
                NameEng=Intercom
                ReadMe=Данная инфошка используется только как маркер. При добавлении боту любой антидоминаторской программы, ему автоматически добавляется и один "Интерком" для условной возможности её активации.
            }
            ProgramShocker5300NPC ^{
                Description=Программа мешает работе электрических цепей, затрудняет навигацию. Робот медленно летает, плохо стреляет.
                Description=<clr><clrEnd>
                Description=Количество запусков: <Data1> шт.
                DescriptionEng=The program disrupts the function of electronic circuits, complicating navigation and impairing the robot's speed and accuracy.
                DescriptionEng=<clr><clrEnd>
                DescriptionEng=Number of runs: <Data1>
                Icon=3
                Name=Шоккер-5300
                NameEng=Shocker-5300
                OnActCode ^{
                    01=dword cur_info = CurInfo();
                    02=dword cur_ship = ScriptItemActShip();
                    03=if(!ShipInNormalSpace(cur_ship)) exit;
                    04=if(!StarBattle(ShipStar(cur_ship))) exit;
                    05=int in_fear = ShipInFear(cur_ship);
                    06=if(ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 3) > CurTurn()) exit;
                    07=if(!fun_init)
                    08 ^{
                        01=unknown ShipNearbyShips = ImportedFunction('UtilityFunctions', 'ShipNearbyShips');
                        02=unknown RndObject = ImportedFunction('UtilityFunctions', 'RndObject');
                        03=int fun_init = 1;
                    }
                    09=dword target;
                    10=if(!in_fear) target = ShipGetBad(cur_ship);
                    11=else
                    12 ^{
                        01=target = ShipNearbyShips(cur_ship, 1, 0, 1, '', '');
                    }
                    13=if(!target) exit;
                    14=if(ShipTypeN(target)) exit;
                    15=if(ShipCustomFaction(target) != '') exit;
                    16=if(DomikProgrammDate(target)) exit;
                    17=if(!in_fear)
                    18 ^{
                        01=if(RndObject(1, 100, cur_ship) <= abs(HullDamage(target) - 100) - 25) exit;
                    }
                    19=else
                    20 ^{
                        01=if(RndObject(1, 100, cur_ship) <= HullDamage(cur_ship) + 25) exit;
                    }
                    21=int sub_type = ShipSubType(target);
                    22=if(!sub_type || sub_type > 5) exit;
                    23=if(ShipScanerPower(cur_ship) <= ShipProtectability(target)) exit;
                    24=if(!in_fear)
                    25 ^{
                        01=if(Dist(cur_ship, target) > 350) exit;
                    }
                    26=else
                    27 ^{
                        01=if(Dist(cur_ship, target) > 400) exit;
                    }
                    28=DomikProgramm(target, 9);
                    29=if(ShipCustomShipInfoData(0, CurInfo(), 1) > 1)
                    30 ^{
                        01=ShipCustomShipInfoData(0, CurInfo(), 1, ShipCustomShipInfoData(0, CurInfo(), 1) - 1);
                    }
                    31=else
                    32 ^{
                        01=ShipDeleteCustomShipInfo(cur_ship, 'ProgramShocker5300NPC');
                    }
                    33=if(ShipCustomShipInfoData(cur_ship, 'ProgramIntercomNPC', 1) > 1)
                    34 ^{
                        01=ShipCustomShipInfoData(cur_ship, 'ProgramIntercomNPC', 1, ShipCustomShipInfoData(cur_ship, 'ProgramIntercomNPC', 1) - 1);
                    }
                    35=else
                    36 ^{
                        01=ShipDeleteCustomShipInfo(cur_ship, 'ProgramIntercomNPC');
                    }
                    37=ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 1, ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 1) - 1);
                    38=if(!in_fear) ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 3, CurTurn() + 8);
                    39=else ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 3, CurTurn() + 2);
                    40=if(ShipInNormalSpace(Player()))
                    41 ^{
                        01=if(ShipStar(cur_ship) == ShipStar(Player()))
                        02 ^{
                            01=if(Dist(cur_ship, Player()) <= ShipRadarRange(Player()))
                            02 ^{
                                01=str text = ItemSubrace(ShipItems(target, 0));
                                02=if(!text) text = 'Blazer';
                                03=else if(1 == text) text = 'Keller';
                                04=else text = 'Terron';
                                05=if(RndObject(0, 1, cur_ship)) text = text + '1';
                                06=str player_name = ShipName(Player());
                                07=SetName(Player(), '*#*NameReplace*#*');
                                08=text = Format(CT('ShipGreetings.Dominator.' + text), CT('ShipType.TypeName.Ranger') + ' *#*NameReplace*#*', Format(Name(cur_ship), ShipName(cur_ship), '*#*NameReplace*#*', ''), '');
                                09=text = Format(text, '*#*NameReplace*#*', ShipName(cur_ship), '255,240,100');
                                10=SetName(Player(), player_name);
                                11=str prog_name = CT('Programms.Shock.Name');
                                12=text = '<color=255,240,100>' + Name(cur_ship) + '</color>' + '-->' + '<color=255,240,100>' + Name(target) + '</color>' + CT('FormInfo.br') + '- ' + text + CT('FormInfo.br') + '- ' + Format(CT('Talk.Dominator.ProgrammPlayer'), '<Name' + '>', prog_name, '255,240,100') + CT('FormInfo.br') + '- ' + Format(CT('Talk.Dominator.ProgrammOk'), '<Name' + '>', prog_name, '255,240,100');
                                13=Ether(1, '', text, cur_ship, target);
                            }
                        }
                    }
                }
                OnActCodeTypes=t_OnStep
                OnActStepTypes=5
            }
            ProgramSystemShutdownNPC ^{
                Description=Все данные робота удаляются. Доминатор отключается, ни на что более не реагирует.
                Description=<clr><clrEnd>
                Description=Количество запусков: <Data1> шт.
                DescriptionEng=All robot data is deleted. The dominator shuts down, unable to respond to any signals.
                DescriptionEng=<clr><clrEnd>
                DescriptionEng=Number of runs: <Data1>
                Icon=3
                Name=Системное отключение
                NameEng=System shutdown
                OnActCode ^{
                    01=dword cur_info = CurInfo();
                    02=dword cur_ship = ScriptItemActShip();
                    03=if(!ShipInNormalSpace(cur_ship)) exit;
                    04=if(!StarBattle(ShipStar(cur_ship))) exit;
                    05=int in_fear = ShipInFear(cur_ship);
                    06=if(ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 3) > CurTurn()) exit;
                    07=if(!fun_init)
                    08 ^{
                        01=unknown ShipNearbyShips = ImportedFunction('UtilityFunctions', 'ShipNearbyShips');
                        02=unknown RndObject = ImportedFunction('UtilityFunctions', 'RndObject');
                        03=int fun_init = 1;
                    }
                    09=dword target;
                    10=if(!in_fear) target = ShipGetBad(cur_ship);
                    11=else
                    12 ^{
                        01=target = ShipNearbyShips(cur_ship, 1, 0, 1, '', '');
                    }
                    13=if(!target) exit;
                    14=if(ShipTypeN(target)) exit;
                    15=if(ShipCustomFaction(target) != '') exit;
                    16=if(DomikProgrammDate(target)) exit;
                    17=if(!in_fear)
                    18 ^{
                        01=if(RndObject(1, 100, cur_ship) <= abs(HullDamage(target) - 100) - 60) exit;
                    }
                    19=else
                    20 ^{
                        01=if(RndObject(1, 100, cur_ship) <= HullDamage(cur_ship) + 15) exit;
                    }
                    21=int sub_type = ShipSubType(target);
                    22=if(!sub_type || sub_type > 3) exit;
                    23=if(ShipScanerPower(cur_ship) <= ShipProtectability(target)) exit;
                    24=if(!in_fear)
                    25 ^{
                        01=if(Dist(cur_ship, target) > 350) exit;
                    }
                    26=else
                    27 ^{
                        01=if(Dist(cur_ship, target) > 400) exit;
                    }
                    28=DomikProgramm(target, 11);
                    29=if(ShipCustomShipInfoData(0, CurInfo(), 1) > 1)
                    30 ^{
                        01=ShipCustomShipInfoData(0, CurInfo(), 1, ShipCustomShipInfoData(0, CurInfo(), 1) - 1);
                    }
                    31=else
                    32 ^{
                        01=ShipDeleteCustomShipInfo(cur_ship, 'ProgramSystemShutdownNPC');
                    }
                    33=if(ShipCustomShipInfoData(cur_ship, 'ProgramIntercomNPC', 1) > 1)
                    34 ^{
                        01=ShipCustomShipInfoData(cur_ship, 'ProgramIntercomNPC', 1, ShipCustomShipInfoData(cur_ship, 'ProgramIntercomNPC', 1) - 1);
                    }
                    35=else
                    36 ^{
                        01=ShipDeleteCustomShipInfo(cur_ship, 'ProgramIntercomNPC');
                    }
                    37=ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 1, ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 1) - 1);
                    38=if(!in_fear) ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 3, CurTurn() + 14);
                    39=else ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 3, CurTurn() + 4);
                    40=if(ShipInNormalSpace(Player()))
                    41 ^{
                        01=if(ShipStar(cur_ship) == ShipStar(Player()))
                        02 ^{
                            01=if(Dist(cur_ship, Player()) <= ShipRadarRange(Player()))
                            02 ^{
                                01=str text = ItemSubrace(ShipItems(target, 0));
                                02=if(!text) text = 'Blazer';
                                03=else if(1 == text) text = 'Keller';
                                04=else text = 'Terron';
                                05=if(RndObject(0, 1, cur_ship)) text = text + '1';
                                06=str player_name = ShipName(Player());
                                07=SetName(Player(), '*#*NameReplace*#*');
                                08=text = Format(CT('ShipGreetings.Dominator.' + text), CT('ShipType.TypeName.Ranger') + ' *#*NameReplace*#*', Format(Name(cur_ship), ShipName(cur_ship), '*#*NameReplace*#*', ''), '');
                                09=text = Format(text, '*#*NameReplace*#*', ShipName(cur_ship), '255,240,100');
                                10=SetName(Player(), player_name);
                                11=str prog_name = CT('Programms.Disconnection.Name');
                                12=text = '<color=255,240,100>' + Name(cur_ship) + '</color>' + '-->' + '<color=255,240,100>' + Name(target) + '</color>' + CT('FormInfo.br') + '- ' + text + CT('FormInfo.br') + '- ' + Format(CT('Talk.Dominator.ProgrammPlayer'), '<Name' + '>', prog_name, '255,240,100') + CT('FormInfo.br') + '- ' + Format(CT('Talk.Dominator.ProgrammOk'), '<Name' + '>', prog_name, '255,240,100');
                                13=Ether(1, '', text, cur_ship, target);
                            }
                        }
                    }
                }
                OnActCodeTypes=t_OnStep
                OnActStepTypes=5
            }
            ProgramWCoderNPC ^{
                Description=Универсальный кодек подбора и замены паролей орудийных систем. Доминатору понадобится время, чтобы восстановить данные.
                Description=<clr><clrEnd>
                Description=Количество запусков: <Data1> шт.
                DescriptionEng=A universal codec for hacking and changing passwords of weapon systems. The targeted dominator will require time to restore the data.
                DescriptionEng=<clr><clrEnd>
                DescriptionEng=Number of runs: <Data1>
                Icon=3
                Name=W-Кодер
                NameEng=W-Coder
                OnActCode ^{
                    01=dword cur_info = CurInfo();
                    02=dword cur_ship = ScriptItemActShip();
                    03=if(!ShipInNormalSpace(cur_ship)) exit;
                    04=if(!StarBattle(ShipStar(cur_ship))) exit;
                    05=int in_fear = ShipInFear(cur_ship);
                    06=if(ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 3) > CurTurn()) exit;
                    07=if(!fun_init)
                    08 ^{
                        01=unknown ShipNearbyShips = ImportedFunction('UtilityFunctions', 'ShipNearbyShips');
                        02=unknown RndObject = ImportedFunction('UtilityFunctions', 'RndObject');
                        03=int fun_init = 1;
                    }
                    09=dword target;
                    10=if(!in_fear) target = ShipGetBad(cur_ship);
                    11=else
                    12 ^{
                        01=target = ShipNearbyShips(cur_ship, 1, 0, 1, '', '');
                    }
                    13=if(!target) exit;
                    14=if(ShipTypeN(target)) exit;
                    15=if(ShipCustomFaction(target) != '') exit;
                    16=if(DomikProgrammDate(target)) exit;
                    17=if(!in_fear)
                    18 ^{
                        01=if(RndObject(1, 100, cur_ship) <= abs(HullDamage(target) - 100) - 45) exit;
                    }
                    19=else
                    20 ^{
                        01=if(RndObject(1, 100, cur_ship) <= HullDamage(cur_ship) + 20) exit;
                    }
                    21=int sub_type = ShipSubType(target);
                    22=if(!sub_type || sub_type > 4) exit;
                    23=if(ShipScanerPower(cur_ship) <= ShipProtectability(target)) exit;
                    24=if(!in_fear)
                    25 ^{
                        01=if(Dist(cur_ship, target) > 350) exit;
                    }
                    26=else
                    27 ^{
                        01=if(Dist(cur_ship, target) > 400) exit;
                    }
                    28=DomikProgramm(target, 7);
                    29=if(ShipCustomShipInfoData(0, CurInfo(), 1) > 1)
                    30 ^{
                        01=ShipCustomShipInfoData(0, CurInfo(), 1, ShipCustomShipInfoData(0, CurInfo(), 1) - 1);
                    }
                    31=else
                    32 ^{
                        01=ShipDeleteCustomShipInfo(cur_ship, 'ProgramWCoderNPC');
                    }
                    33=if(ShipCustomShipInfoData(cur_ship, 'ProgramIntercomNPC', 1) > 1)
                    34 ^{
                        01=ShipCustomShipInfoData(cur_ship, 'ProgramIntercomNPC', 1, ShipCustomShipInfoData(cur_ship, 'ProgramIntercomNPC', 1) - 1);
                    }
                    35=else
                    36 ^{
                        01=ShipDeleteCustomShipInfo(cur_ship, 'ProgramIntercomNPC');
                    }
                    37=ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 1, ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 1) - 1);
                    38=if(!in_fear) ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 3, CurTurn() + 12);
                    39=else ShipCustomShipInfoData(cur_ship, 'ShipWithProgramsInfo', 3, CurTurn() + 3);
                    40=if(ShipInNormalSpace(Player()))
                    41 ^{
                        01=if(ShipStar(cur_ship) == ShipStar(Player()))
                        02 ^{
                            01=if(Dist(cur_ship, Player()) <= ShipRadarRange(Player()))
                            02 ^{
                                01=str text = ItemSubrace(ShipItems(target, 0));
                                02=if(!text) text = 'Blazer';
                                03=else if(1 == text) text = 'Keller';
                                04=else text = 'Terron';
                                05=if(RndObject(0, 1, cur_ship)) text = text + '1';
                                06=str player_name = ShipName(Player());
                                07=SetName(Player(), '*#*NameReplace*#*');
                                08=text = Format(CT('ShipGreetings.Dominator.' + text), CT('ShipType.TypeName.Ranger') + ' *#*NameReplace*#*', Format(Name(cur_ship), ShipName(cur_ship), '*#*NameReplace*#*', ''), '');
                                09=text = Format(text, '*#*NameReplace*#*', ShipName(cur_ship), '255,240,100');
                                10=SetName(Player(), player_name);
                                11=str prog_name = CT('Programms.WeaponBlocking.Name');
                                12=text = '<color=255,240,100>' + Name(cur_ship) + '</color>' + '-->' + '<color=255,240,100>' + Name(target) + '</color>' + CT('FormInfo.br') + '- ' + text + CT('FormInfo.br') + '- ' + Format(CT('Talk.Dominator.ProgrammPlayer'), '<Name' + '>', prog_name, '255,240,100') + CT('FormInfo.br') + '- ' + Format(CT('Talk.Dominator.ProgrammOk'), '<Name' + '>', prog_name, '255,240,100');
                                13=Ether(1, '', text, cur_ship, target);
                            }
                        }
                    }
                }
                OnActCodeTypes=t_OnStep
                OnActStepTypes=5
            }
            ShipWithProgramsInfo ^{
                Description=Используется для автоматического пополнения запаса программ у NPC, имеющего данную инфошку
                Icon=3
                Name=
                OnActCode ^{
                    01=dword cur_info = CurInfo();
                    02=dword cur_ship = ScriptItemActShip();
                    03=if(ShipInNormalSpace(cur_ship)) exit;
                    04=if(ShipInPrison(cur_ship)) exit;
                    05=if(!ShipEqInSlot(cur_ship, t_Scaner)) exit;
                    06=if(ShipCustomShipInfoData(0, cur_info, 1) >= ShipCustomShipInfoData(0, cur_info, 2)) exit;
                    07=if(CurTurn() < ShipCustomShipInfoTextData(0, cur_info, 1)) exit;
                    08=dword place = GetShipPlanet(cur_ship);
                    09=if(!place) place = GetShipRuins(cur_ship);
                    10=if(!place) exit;
                    11=if(!fun_init)
                    12 ^{
                        01=unknown RndObject = ImportedFunction('UtilityFunctions', 'RndObject');
                        02=int fun_init = 1;
                    }
                    13=str ship_type = ShipType(cur_ship);
                    14=if(RndObject(1, 100, cur_ship) <= ProgramsDistChancesArray[ship_type, 'ProgramsGetChance'])
                    15 ^{
                        01=str check = max(1, RndObject(1, 100, cur_ship) - (10 - 1.25 * GalaxyTechLevel()));
                        02=for(int i = 1; i <= ProgramsDistChancesArray[ship_type, 'ProgramsCount']; i = i + 1)
                        03 ^{
                            01=if(int(check) <= ProgramsDistChancesArray[ship_type, i])
                            02 ^{
                                01=check = i;
                                02=break;
                            }
                        }
                        04=check = GetVariableName(ProgramsDistChancesArray[ship_type, int(check)]);
                        05=check = 'Program' + check + 'NPC';
                        06=int prog_num = ShipFindCustomShipInfoByType(cur_ship, check);
                        07=if(~prog_num)
                        08 ^{
                            01=ShipCustomShipInfoData(cur_ship, 'ProgramIntercomNPC', 1, ShipCustomShipInfoData(cur_ship, 'ProgramIntercomNPC', 1) + 1);
                            02=ShipCustomShipInfoData(cur_ship, prog_num, 1, ShipCustomShipInfoData(cur_ship, prog_num, 1) + 1);
                        }
                        09=else
                        10 ^{
                            01=prog_num = ShipFindCustomShipInfoByType(cur_ship, 'ProgramIntercomNPC');
                            02=if(~prog_num) ShipCustomShipInfoData(cur_ship, 'ProgramIntercomNPC', 1, ShipCustomShipInfoData(cur_ship, 'ProgramIntercomNPC', 1) + 1);
                            03=else ShipAddCustomShipInfo(cur_ship, 'ProgramIntercomNPC', '', 1);
                            04=ShipAddCustomShipInfo(cur_ship, check, '', 1);
                        }
                        11=ShipCustomShipInfoData(0, cur_info, 1, ShipCustomShipInfoData(0, cur_info, 1) + 1);
                    }
                    16=ShipCustomShipInfoTextData(0, cur_info, 1, CurTurn() + 30);
                }
                OnActCodeTypes=t_OnStep
                OnActStepTypes=11
            }
        }
    }
}
Programms ^{
    Disconnection ^{
        AddToShipInfo=Выключен
        Name=Системное отключение
        Text=Все данные робота удаляются. Доминатор отключается, ни на что более не реагирует.
        Text=<clr><clrEnd>
        Text=Количество запусков: <Count> шт.
    }
    Insanity ^{
        AddToShipInfo=Перегрузка системы
        Name=Гатрикс матрица
        Text=Огромная матрица беспорядочных данных перегружает электронные схемы робота потоком информации. Робот бессмысленно летает и стреляет наугад.
        Text=<clr><clrEnd>
        Text=Количество запусков: <Count> шт.
    }
    Intercom ^{
        Name=Интерком
        Text=Программа загружается в бортовой компьютер, она позволяет декодировать речь доминаторов. Для большинства доминаторов необходимо преодолеть защитное поле с помощью сканера.
        Text=<clr><clrEnd>
        Text=Количество запусков: <Count> шт.
    }
    SelfDestruction ^{
        AddToShipInfo=Нуль-приказ
        Name=Абсолютное оружие
        Text=Приказ нулевого уровня на самоуничтожение. Доминаторы подчиняются беспрекословно.
        Text=<clr><clrEnd>
        Text=Количество запусков: <Count> шт.
    }
    Shipwreck ^{
        AddToShipInfo=Аварийный сигнал
        Name=Аварийный сигнал
        Text=Получив аварийный сигнал, доминатор выбросит часть оборудования и оружия.
        Text=<clr><clrEnd>
        Text=Количество запусков: <Count> шт.
    }
    Shock ^{
        AddToShipInfo=Электромагнитный шок
        Name=Шоккер-5300
        Text=Программа мешает работе электрических цепей, затрудняет навигацию. Робот медленно летает, плохо стреляет.
        Text=<clr><clrEnd>
        Text=Количество запусков: <Count> шт.
    }
    WeaponBlocking ^{
        AddToShipInfo=Блокировка орудий
        Name=W-Кодер
        Text=Универсальный кодек подбора и замены паролей орудийных систем. Доминатору понадобится время, чтобы восстановить данные.
        Text=<clr><clrEnd>
        Text=Количество запусков: <Count> шт.
    }
}
